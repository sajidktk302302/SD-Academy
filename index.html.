<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Courses / پرو کورسز</title>
    <style>
        /* CSS styles are unchanged, so they are omitted for brevity. You can copy them from the previous response. */
        :root {
            --primary-color: #00796b; --secondary-color: #ffc107; --background-color: #f4f4f9;
            --card-background: #ffffff; --text-color: #333333; --lock-color: #d32f2f; --unlock-color: #388e3c;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0; padding: 0 0 80px 0; background-color: var(--background-color); color: var(--text-color);
        }
        .container { padding: 15px; } h1, h2 { color: var(--primary-color); }
        .tab-content { display: none; } .tab-content.active { display: block; }
        .course-card { background-color: var(--card-background); border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin-bottom: 20px; overflow: hidden; }
        .course-card img { width: 100%; height: 180px; object-fit: cover; } .course-info { padding: 15px; }
        .course-title { font-size: 1.2rem; font-weight: bold; margin: 0 0 10px 0; } .course-status { display: flex; align-items: center; gap: 10px; }
        .status-icon { font-size: 1.5rem; }
        .btn { background-color: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; text-align: center; }
        .btn-watch { background-color: var(--unlock-color); } .btn-pending { background-color: var(--secondary-color); color: #333; cursor: not-allowed;}
        .shop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--card-background); box-shadow: 0 -2px 10px rgba(0,0,0,0.1); display: flex; justify-content: space-around; padding: 10px 0; }
        .nav-item { cursor: pointer; text-align: center; color: #757575; } .nav-item.active { color: var(--primary-color); }
        .nav-icon { font-size: 24px; } .nav-text { font-size: 12px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: var(--card-background); margin: 15% auto; padding: 20px; border-radius: 12px; width: 90%; max-width: 500px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 20px; }
        .close-btn { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        .form-group { margin-bottom: 15px; } .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .qr-code { text-align: center; margin: 20px 0; } .qr-code img { max-width: 150px; border: 1px solid #ddd; padding: 5px; }
        .wallet-address { background-color: #f0f0f0; padding: 10px; border-radius: 8px; font-family: monospace; word-wrap: break-word; text-align: center; }
    </style>
</head>
<body>

    <div id="home-tab" class="tab-content active"><div class="container" id="featured-course-container"></div></div>
    <div id="shop-tab" class="tab-content"><div class="container"><h2>All Courses / تمام کورسز</h2><div class="shop-grid" id="all-courses-container"></div></div></div>
    <div id="signals-tab" class="tab-content"><div class="container" style="text-align: center; padding-top: 50px;"><span style="font-size: 5rem;">📶</span><h1>Signals Coming Soon</h1><h2>سگنلز جلد آرہے ہیں</h2></div></div>

    <footer class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home-tab')"><div class="nav-icon">🏠</div><div class="nav-text">Home / ہوم</div></div>
        <div class="nav-item" onclick="switchTab('shop-tab')"><div class="nav-icon">🛒</div><div class="nav-text">Shop / شاپ</div></div>
        <div class="nav-item" onclick="switchTab('signals-tab')"><div class="nav-icon">📶</div><div class="nav-text">Signals / سگنلز</div></div>
    </footer>

    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Payment Details / ادائیگی کی تفصیلات</h2>
                <span class="close-btn" onclick="closeModal('paymentModal')">×</span>
            </div>
            <p>To unlock, transfer the fee to the account below. After payment, fill and submit the form.</p>
            <div class="qr-code">
                <img id="qr-code-image" src="" alt="Payment QR Code">
            </div>
            <label id="wallet-label">Account Number:</label>
            <div id="wallet-address-display" class="wallet-address"></div>
            <form id="payment-form" style="margin-top: 20px;">
                <input type="hidden" id="course-id-input">
                <div class="form-group"><label for="user-name">Your Name / آپ کا نام</label><input type="text" id="user-name" required></div>
                <div class="form-group"><label for="tx-id">Transaction ID / ٹرانزیکشن آئی ڈی</label><input type="text" id="tx-id" required></div>
                <div class="form-group"><label for="amount">Amount Sent (Optional) / بھیجی گئی رقم</label><input type="text" id="amount"></div>
                <button type="submit" class="btn" style="width: 100%;">Submit for Approval</button>
            </form>
        </div>
    </div>

    <div id="videoModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="video-modal-title"></h2><span class="close-btn" onclick="closeModal('videoModal')">×</span></div><p>Course Video Link:</p><a id="video-link" href="#" target="_blank" style="font-weight:bold; word-wrap:break-word;"></a></div></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DATABASE INITIALIZATION ---
    function getDB() {
        // Default data used ONLY if admin hasn't set anything up yet.
        const defaultCourses = [{ id: 1, title: 'Pro Trading Course', image: 'https://i.ibb.co/68vRPT4/course1.jpg', videoUrl: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ', isFeatured: true }];
        const defaultSettings = {
            paymentMethodName: "Binance Pay ID",
            walletAddress: "ADMIN_HAS_NOT_SET_THIS",
            qrCodeImage: "https://i.ibb.co/L9jM1pY/sample-qr.png"
        };
        const courses = JSON.parse(localStorage.getItem('courses')) || defaultCourses;
        const appSettings = JSON.parse(localStorage.getItem('appSettings')) || defaultSettings;
        const unlockedCourses = JSON.parse(localStorage.getItem('unlockedCourses')) || [];
        const submissions = JSON.parse(localStorage.getItem('submissions')) || [];
        
        if (!localStorage.getItem('courses')) localStorage.setItem('courses', JSON.stringify(courses));
        if (!localStorage.getItem('appSettings')) localStorage.setItem('appSettings', JSON.stringify(appSettings));

        return { courses, unlockedCourses, submissions, appSettings };
    }

    // --- RENDER LOGIC ---
    function renderCourses() {
        const { courses, unlockedCourses, submissions } = getDB();
        const featuredContainer = document.getElementById('featured-course-container');
        const allCoursesContainer = document.getElementById('all-courses-container');
        featuredContainer.innerHTML = '';
        allCoursesContainer.innerHTML = '';
        
        const featuredCourse = courses.find(c => c.isFeatured);
        if (featuredCourse) featuredContainer.innerHTML = createCourseCard(featuredCourse, unlockedCourses, submissions);
        courses.forEach(course => { allCoursesContainer.innerHTML += createCourseCard(course, unlockedCourses, submissions); });
    }

    function createCourseCard(course, unlockedCourses, submissions) {
        const isUnlocked = unlockedCourses.includes(course.id);
        const isPending = submissions.some(s => s.courseId === course.id && s.status === 'pending');
        let buttonHtml, lockIcon = `<span class="status-icon" style="color: var(--lock-color);">🔒</span>`;
        if (isUnlocked) {
            lockIcon = `<span class="status-icon" style="color: var(--unlock-color);">🔓</span>`;
            buttonHtml = `<button class="btn btn-watch" onclick="showVideo(${course.id})">Watch Now / ابھی دیکھیں</button>`;
        } else if (isPending) {
            buttonHtml = `<button class="btn btn-pending" disabled>Pending Approval</button>`;
        } else {
            buttonHtml = `<button class="btn" onclick="openPaymentModal(${course.id})">Unlock Course</button>`;
        }
        return `<div class="course-card"><img src="${course.image}" alt="${course.title}"><div class="course-info"><h3 class="course-title">${course.title}</h3><div class="course-status">${lockIcon}${buttonHtml}</div></div></div>`;
    }

    // --- UI INTERACTIONS ---
    window.switchTab = (tabId) => {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
        document.querySelector(`.nav-item[onclick="switchTab('${tabId}')"]`).classList.add('active');
    };

    window.openPaymentModal = (courseId) => {
        const { appSettings } = getDB();
        // Populate modal with settings from admin panel
        document.getElementById('wallet-label').innerText = appSettings.paymentMethodName + ':';
        document.getElementById('wallet-address-display').innerText = appSettings.walletAddress;
        document.getElementById('qr-code-image').src = appSettings.qrCodeImage;
        
        document.getElementById('course-id-input').value = courseId;
        document.getElementById('paymentModal').style.display = 'block';
    };
    
    window.showVideo = (courseId) => {
        const { courses } = getDB();
        const course = courses.find(c => c.id === courseId);
        if (course) {
            document.getElementById('video-modal-title').innerText = course.title;
            const videoLink = document.getElementById('video-link');
            videoLink.href = course.videoUrl;
            videoLink.innerText = course.videoUrl;
            document.getElementById('videoModal').style.display = 'block';
        }
    };

    window.closeModal = (modalId) => { document.getElementById(modalId).style.display = 'none'; };

    document.getElementById('payment-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const { submissions } = getDB();
        submissions.push({
            id: Date.now(),
            courseId: parseInt(document.getElementById('course-id-input').value),
            userName: document.getElementById('user-name').value,
            txId: document.getElementById('tx-id').value,
            amount: document.getElementById('amount').value,
            status: 'pending'
        });
        localStorage.setItem('submissions', JSON.stringify(submissions));
        alert('Submission successful! Your request is pending approval.');
        closeModal('paymentModal');
        e.target.reset();
        renderCourses();
    });

    renderCourses(); // Initial load
});
</script>
</body>
</html>
